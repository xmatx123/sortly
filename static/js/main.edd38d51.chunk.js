(this["webpackJsonpsortly-de"]=this["webpackJsonpsortly-de"]||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/logo.3de73253.png"},,,,,,,function(e,t,a){e.exports=a.p+"static/media/population.b123bcc2.jpg"},function(e,t,a){e.exports=a.p+"static/media/area.1a41ffef.jpg"},,,,,function(e,t,a){e.exports=a(63)},,,,,,,,,,function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(20),c=a.n(o),l=a(8),i=a(67),s=a(27),m=a(3),u=a(13),d=a.n(u),p=(a(39),a(16)),g=a.n(p),b=a(14),v=a(22),y=a(5);const E=Object(v.a)({apiKey:"AIzaSyAOZkZ8FGkHv6J4xD-yckuKOasuO4zEF2c",authDomain:"sortly-1b701.firebaseapp.com",projectId:"sortly-1b701",storageBucket:"sortly-1b701.firebasestorage.app",messagingSenderId:"37869262835",appId:"1:37869262835:web:9d463c1b217727d88e6486"}),h=Object(b.b)(E),f=Object(y.f)(E);const O=Object(n.createContext)();function j(){return Object(n.useContext)(O)}function N(e){let{children:t}=e;const[a,o]=Object(n.useState)(null),[c,l]=Object(n.useState)(!0);Object(n.useEffect)(()=>Object(b.c)(h,e=>{o(e),l(!1)}),[]);const i={currentUser:a,signup:function(e,t){return Object(b.a)(h,e,t)},login:function(e,t){return Object(b.d)(h,e,t)},logout:function(){return Object(b.e)(h)}};return r.a.createElement(O.Provider,{value:i},!c&&t)}const k={getAvatarOptions:()=>[{id:"default",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=default",name:"Default"},{id:"happy",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=happy",name:"Happy"},{id:"cool",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=cool",name:"Cool"},{id:"smart",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=smart",name:"Smart"},{id:"friendly",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=friendly",name:"Friendly"},{id:"adventurous",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=adventurous",name:"Adventurous"},{id:"creative",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=creative",name:"Creative"},{id:"mysterious",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=mysterious",name:"Mysterious"}]},S={async getUserProfile(e){try{const t=await Object(y.d)(Object(y.c)(f,"users",e));if(t.exists())return t.data();const a={nickname:"",country:"",avatarUrl:k.getAvatarOptions()[0].url,createdAt:new Date};return await this.updateUserProfile(e,a),a}catch(t){throw console.error("Error getting user profile:",t),t}},async updateUserProfile(e,t){try{const a=Object(y.c)(f,"users",e);await Object(y.k)(a,{...t,updatedAt:new Date},{merge:!0})}catch(a){throw console.error("Error updating user profile:",a),a}},async updateProfileField(e,t,a){try{const n=Object(y.c)(f,"users",e);await Object(y.l)(n,{[t]:a,updatedAt:new Date})}catch(n){throw console.error("Error updating profile field:",n),n}}};a(44);function C(){const{currentUser:e,login:t,signup:a,logout:o}=j(),[c,l]=Object(n.useState)(""),[i,s]=Object(n.useState)(""),[u,d]=Object(n.useState)(""),[p,g]=Object(n.useState)(!1),[b,v]=Object(n.useState)(!1),[y,E]=Object(n.useState)(null),h=Object(m.o)();return Object(n.useEffect)(()=>{(async()=>{if(e)try{const t=await S.getUserProfile(e.uid);E(t)}catch(u){console.error("Error loading user profile:",u)}})()},[e]),e?r.a.createElement("div",{className:"login-button"},r.a.createElement("div",{className:"user-profile-button",onClick:()=>h("/profile")},r.a.createElement("img",{src:(null===y||void 0===y?void 0:y.avatarUrl)||k.getAvatarOptions()[0].url,alt:"Profile",className:"header-avatar"}),r.a.createElement("span",{className:"user-name"},(null===y||void 0===y?void 0:y.nickname)||e.email)),r.a.createElement("button",{onClick:async function(){try{d(""),g(!0),await o(),h("/")}catch(u){d("Failed to log out: "+u.message)}g(!1)},disabled:p,className:"logout-button"},"Log Out")):r.a.createElement("div",{className:"login-button"},b?r.a.createElement("div",{className:"login-form"},r.a.createElement("input",{type:"email",value:c,onChange:e=>l(e.target.value),placeholder:"Email",required:!0}),r.a.createElement("input",{type:"password",value:i,onChange:e=>s(e.target.value),placeholder:"Password",required:!0}),r.a.createElement("div",{className:"login-buttons"},r.a.createElement("button",{onClick:async function(e){e.preventDefault();try{d(""),g(!0),await t(c,i),v(!1),h("/profile")}catch(u){d("Failed to log in: "+u.message)}g(!1)},disabled:p},"Login"),r.a.createElement("button",{onClick:async function(e){e.preventDefault();try{d(""),g(!0),await a(c,i),v(!1),h("/profile")}catch(u){d("Failed to create an account: "+u.message)}g(!1)},disabled:p},"Sign Up"),r.a.createElement("button",{onClick:()=>v(!1)},"Cancel")),u&&r.a.createElement("p",{style:{color:"red"}},u)):r.a.createElement("button",{onClick:()=>v(!0)},"Login / Sign Up"))}var w=function(){const[e,t]=Object(n.useState)(!1),a=()=>{t(!1)};return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"header-container"},r.a.createElement(l.b,{to:"/",className:"header-logo",onClick:a},r.a.createElement("img",{src:g.a,alt:"Sortly Logo",className:"logo-image"}),r.a.createElement("span",{className:"site-name"},"Sortly - The Sorting Game")),r.a.createElement("button",{className:"menu-button",onClick:()=>{t(!e)}},"\u2630"),r.a.createElement("nav",{className:"header-nav "+(e?"active":"")},r.a.createElement(l.b,{to:"/",className:"nav-link",onClick:a},"Home"),r.a.createElement(l.b,{to:"/game/population",className:"nav-link",onClick:a},"Population"),r.a.createElement(l.b,{to:"/game/area",className:"nav-link",onClick:a},"Area"),r.a.createElement(l.b,{to:"/leaderboard",className:"nav-link",onClick:a},"Leaderboard"),r.a.createElement("div",{className:"nav-login"},r.a.createElement(C,null)))))};a(45);var A=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("div",{className:"footer-container"},r.a.createElement("img",{src:g.a,alt:"Sortly Logo",className:"footer-logo"}),r.a.createElement("p",null,"\xa9 ",(new Date).getFullYear()," Sortly. All rights reserved.")))},U=a(23),P=a.n(U),G=a(24),x=a.n(G);a(46);var D=function(){const e=Object(m.o)();return r.a.createElement("div",{className:"homepage"},r.a.createElement("div",{className:"section population-section",style:{backgroundImage:`url(${P.a})`,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}},r.a.createElement("div",{className:"overlay"},r.a.createElement("h2",null,"Sort by Population"),r.a.createElement("div",{className:"population-modes"},r.a.createElement("button",{className:"button button-primary",onClick:()=>{d.a.event({category:"Game",action:"Clicked Play Population Game"}),e("/game/population")}},"Classic Mode"),r.a.createElement("button",{className:"button button-primary",onClick:()=>{d.a.event({category:"Game",action:"Clicked Play Cooperation Game"}),e("/game/population/cooperation")}},"Cooperation Mode")))),r.a.createElement("div",{className:"section area-section",style:{backgroundImage:`url(${x.a})`,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}},r.a.createElement("div",{className:"overlay"},r.a.createElement("h2",null,"Sort by Area"),r.a.createElement("button",{className:"button button-primary",onClick:()=>{d.a.event({category:"Game",action:"Clicked Play Area Game"}),e("/game/area")}},"Play Now"))))};a(47);var L=function(e){let{country:t,isClickable:a,highlight:o,mode:c}=e;const[l,i]=Object(n.useState)(!1),s=o?"highlighted-"+o:"";return r.a.createElement("div",{className:`country-card ${l?"flipped":""} ${a?"clickable":""} ${s}`,onClick:()=>{a&&i(!l)}},r.a.createElement("div",{className:"card-inner"},r.a.createElement("div",{className:"card-face card-front "+s},r.a.createElement("img",{src:t.flagUrl,alt:"Flag of "+t.name,className:"country-flag"}),r.a.createElement("div",{className:"country-info"},r.a.createElement("h3",{className:"country-name"},t.name))),r.a.createElement("div",{className:"card-face card-back "+s},r.a.createElement("div",{className:"country-info"},r.a.createElement("h3",{className:"country-name"},t.name),r.a.createElement("p",{className:"country-detail"},{population:"Population: "+t.population.toLocaleString(),area:`Area: ${t.area.toLocaleString()} km\xb2`}[c]||"")))))};a(48);const I={population:{sorting:{bronze:{id:"population_sorting_bronze",title:"Population Bronze Sorter",description:"Correctly sort 3 countries by population",icon:"\ud83e\udd49",requirement:3},silver:{id:"population_sorting_silver",title:"Population Silver Sorter",description:"Correctly sort 7 countries by population",icon:"\ud83e\udd48",requirement:7},gold:{id:"population_sorting_gold",title:"Population Gold Sorter",description:"Correctly sort 12 countries by population",icon:"\ud83e\udd47",requirement:12},platinum:{id:"population_sorting_platinum",title:"Population Platinum Sorter",description:"Correctly sort 20 countries by population",icon:"\ud83d\udc51",requirement:20}},gameCount:{id:"population_games",title:"Population Game Master",description:"Complete 50 population sorting games",icon:"\ud83c\udfae",requirement:50}},area:{sorting:{bronze:{id:"area_sorting_bronze",title:"Area Bronze Sorter",description:"Correctly sort 3 countries by area",icon:"\ud83e\udd49",requirement:3},silver:{id:"area_sorting_silver",title:"Area Silver Sorter",description:"Correctly sort 7 countries by area",icon:"\ud83e\udd48",requirement:7},gold:{id:"area_sorting_gold",title:"Area Gold Sorter",description:"Correctly sort 12 countries by area",icon:"\ud83e\udd47",requirement:12},platinum:{id:"area_sorting_platinum",title:"Area Platinum Sorter",description:"Correctly sort 20 countries by area",icon:"\ud83d\udc51",requirement:20}},gameCount:{id:"area_games",title:"Area Game Master",description:"Complete 50 area sorting games",icon:"\ud83c\udfae",requirement:50}}},M={async getUserAchievements(e){try{const t=await Object(y.d)(Object(y.c)(f,"achievements",e));return t.exists()?t.data():null}catch(t){throw console.error("Error getting user achievements:",t),t}},async updateUserAchievements(e,t){try{await Object(y.k)(Object(y.c)(f,"achievements",e),{...t,updatedAt:Object(y.j)()},{merge:!0})}catch(a){throw console.error("Error updating user achievements:",a),a}},async checkAndUpdateAchievements(e,t,a){try{var n,r;const o=await this.getUserAchievements(e)||{},c=I[t];let l=!1;Object.values(c.sorting).forEach(e=>{!o[e.id]&&a>=e.requirement&&(o[e.id]={unlocked:!0,unlockedAt:Object(y.j)()},l=!0)});const i=c.gameCount,s=((null===(n=o[i.id])||void 0===n?void 0:n.count)||0)+1;return s>=i.requirement&&!(null===(r=o[i.id])||void 0===r?void 0:r.unlocked)?(o[i.id]={unlocked:!0,unlockedAt:Object(y.j)(),count:s},l=!0):(o[i.id]={...o[i.id],count:s},l=!0),l&&await this.updateUserAchievements(e,o),o}catch(o){throw console.error("Error checking achievements:",o),o}},getAchievementDefinitions:()=>I};var F=function(){const{currentUser:e}=j(),[t,a]=Object(n.useState)([]),[o,c]=Object(n.useState)(null),[l,i]=Object(n.useState)([]),[s,u]=Object(n.useState)(0),[d,p]=Object(n.useState)(null),[g,b]=Object(n.useState)(!1),[v,y]=Object(n.useState)(""),[E,h]=Object(n.useState)("waiting"),f=Object(m.o)(),O=Object(m.m)(),N=e=>{const t=Math.floor(Math.random()*e.length);return e.splice(t,1)[0]},k=Object(n.useCallback)(e=>{const t=[...e];if(g){const e=[];for(let a=0;a<10&&0!==t.length;a++)e.push(N(t));const n=N(e);a([n]),i(e),u(1),c(null),h("playing");const r=[...e],o=Math.floor(Math.random()*r.length),l=r.splice(o,1)[0];return c(l),void i(r)}const n=N(t),r=N(t);a([n]),i(t),u(1),c(r),h("playing")},[g]);Object(n.useEffect)(()=>{(async()=>{const e=O.pathname;if(b(e.includes("cooperation")),g){var t;const{players:e,lobbyId:a}=O.state||{};if(!e||!a)return void f("/game/population/cooperation");const n=e.find(e=>"player1"===e.id)?"player1":"player2";y((null===(t=e.find(e=>e.id===n))||void 0===t?void 0:t.name)||n)}const a=(await(async()=>{try{const e=await fetch("https://restcountries.com/v3.1/all");if(!e.ok)throw new Error("HTTP error! status: "+e.status);const t=await e.json();if(!Array.isArray(t))throw new Error("Invalid data format received from API");const a=t.filter(e=>{var t,a;return e.unMember&&(null===(t=e.name)||void 0===t?void 0:t.common)&&(null===(a=e.flags)||void 0===a?void 0:a.svg)&&"number"===typeof e.population&&"number"===typeof e.area});return a.map((e,t)=>({id:t+1,name:e.name.common,flagUrl:e.flags.svg,population:e.population,area:e.area}))}catch(e){throw console.error("Error fetching countries:",e),new Error("Failed to fetch countries data. Please try again later.")}})()).filter(e=>e.population&&e.area&&e.flagUrl);k(a)})()},[k,O,f,g]);const S=O.pathname.includes("area")?"area":"population",C=async n=>{const r=[...t];if(r.splice(n,0,o),w(r))a(r),u(e=>e+1),c(null),(async()=>{if(0===l.length){if(console.log("Game completed successfully!"),console.log("Final score:",s),e&&!g)try{const t=await M.checkAndUpdateAchievements(e.uid,O.pathname.split("/")[2],s);console.log("Updated achievements:",t)}catch(r){console.error("Error updating achievements:",r)}return void f("/gameover",{state:{score:s,message:"Congratulations! You sorted all countries correctly."}})}const t=[...l],a=Math.floor(Math.random()*t.length),n=t.splice(a,1)[0];c(n),i(t)})();else{const a=[...[...t,o]].sort((e,t)=>e[S]-t[S]);if(console.log("Game ended with incorrect placement"),console.log("Final score:",s),e&&!g)try{const t=await M.checkAndUpdateAchievements(e.uid,O.pathname.split("/")[2],s);console.log("Updated achievements:",t)}catch(m){console.error("Error updating achievements:",m)}f("/gameover",{state:{score:s,message:g?"Game Over! One of the players made a mistake.":"Incorrect placement!",incorrectCountry:o,userOrder:r,correctOrder:a}})}},w=e=>{for(let t=0;t<e.length-1;t++)if(e[t][S]>e[t+1][S])return!1;return!0};return"waiting"===E?r.a.createElement("div",{className:"game-page"},"Loading..."):r.a.createElement("div",{className:"game-page"},r.a.createElement("h2",null,g?"Cooperation Mode":`Sort Countries by ${"area"===S?"Area":"Population"} (Ascending)`),g&&r.a.createElement("p",null,"Current Player: ",v),r.a.createElement("p",null,"Score: ",s-1),r.a.createElement("div",{className:"sorted-countries-container"},o&&r.a.createElement("div",{className:"instructions"},r.a.createElement("p",null,"Where does ",r.a.createElement("strong",null,o.name)," fit among the sorted countries?")),r.a.createElement("div",{className:"sorted-countries"},t.map((e,t)=>r.a.createElement(L,{key:"country-"+e.id,country:e,isClickable:!0,mode:S,highlight:d===t?"hover":""}))),o&&r.a.createElement("div",{className:"insert-buttons"},r.a.createElement("button",{className:"insert-button lower-button",onClick:()=>C(0),onMouseEnter:()=>p(0),onMouseLeave:()=>p(null)},"\u2193"),t.map((e,a)=>r.a.createElement("button",{key:"insert-"+(a+1),className:"insert-button "+(a===t.length-1?"higher-button":"here-button"),onClick:()=>C(a+1),onMouseEnter:()=>p(a+1),onMouseLeave:()=>p(null)},a===t.length-1?"\u2191":a+1)))),o&&r.a.createElement("div",{className:"current-country"},r.a.createElement("h3",null,"Current Country:"),r.a.createElement(L,{country:o,isClickable:!1,mode:S})),g&&l.length>0&&r.a.createElement("div",{className:"remaining-countries"},r.a.createElement("h3",null,"Remaining Countries to Sort:"),r.a.createElement("div",{className:"remaining-countries-grid"},l.map(e=>r.a.createElement(L,{key:"remaining-"+e.id,country:e,isClickable:!1,mode:S})))))};const _=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=JSON.parse(localStorage.getItem("sortly_leaderboard")||"[]");return e?t.filter(t=>t.mode===e):t},q=["population","area"],T={async getTopGames(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;try{const n=Object(y.b)(f,"gameHistory"),r=Object(y.i)(n,Object(y.m)("userId","==",e),Object(y.m)("category","==",t),Object(y.h)("score","desc"),Object(y.g)(a));return(await Object(y.e)(r)).docs.map(e=>({id:e.id,...e.data()}))}catch(n){const r=Object(y.i)(Object(y.b)(f,"gameHistory"),Object(y.m)("userId","==",e),Object(y.m)("category","==",t));return(await Object(y.e)(r)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>t.score-e.score).slice(0,a)}},async getAllTopGames(e){try{const t={};return await Promise.all(q.map(async a=>{t[a]=await this.getTopGames(e,a)})),t}catch(t){return console.error("Error fetching all top games:",t),{}}},async saveGame(e,t,a,n){try{const r=n.map(e=>{let{id:t,name:a,flagUrl:n}=e;return{id:t,name:a,flagUrl:n}});await Object(y.a)(Object(y.b)(f,"gameHistory"),{userId:e,category:t,score:a,countries:r,timestamp:Object(y.j)()})}catch(r){throw console.error("Error saving game history:",r),r}}};a(49),a(50);var z=function(){const e=Object(m.m)(),t=Object(m.o)(),{currentUser:a}=j(),{score:o,message:c,incorrectCountry:l,userOrder:i,correctOrder:s,mode:u}=e.state||{},[d,p]=Object(n.useState)(""),[g,b]=Object(n.useState)(!1),[v,y]=Object(n.useState)(""),E=Object(n.useRef)(!1);return Object(n.useEffect)(()=>{(async()=>{if(a)try{const e=await S.getUserProfile(a.uid);(null===e||void 0===e?void 0:e.nickname)&&p(e.nickname)}catch(v){console.error("Error fetching user profile:",v)}})()},[a]),Object(n.useEffect)(()=>{(async()=>{if(a&&i&&!E.current)try{console.log("Attempting to save game history:",{userId:a.uid,mode:u,score:o-1,countriesCount:i.length}),await T.saveGame(a.uid,u,o-1,i.map(e=>({id:e.id,name:e.name,flagUrl:e.flagUrl}))),E.current=!0,console.log("Game history saved successfully")}catch(v){console.error("Error saving game history:",v)}})()},[a,i,u,o]),r.a.createElement("div",{className:"game-over-page"},r.a.createElement("h2",null,"Game Over"),r.a.createElement("p",null,c),r.a.createElement("p",null,"Your final score: ",o-1),g?r.a.createElement("div",{className:"submission-success"},r.a.createElement("p",null,"Score submitted successfully!")):r.a.createElement("form",{onSubmit:e=>{if(e.preventDefault(),d.trim())try{((e,t,a)=>{const n=_(),r={id:Date.now(),playerName:e,score:t,mode:a,date:(new Date).toISOString()};n.push(r),n.sort((e,t)=>t.score-e.score);const o=n.slice(0,100);localStorage.setItem("sortly_leaderboard",JSON.stringify(o))})(d,o-1,u),b(!0)}catch(t){y("Failed to submit score. Please try again.")}else y("Please enter your name")},className:"score-submission"},r.a.createElement("div",{className:"input-group"},r.a.createElement("label",{htmlFor:"playerName"},"Enter your name:"),r.a.createElement("input",{type:"text",id:"playerName",value:d,onChange:e=>p(e.target.value),placeholder:"Your name",maxLength:20})),v&&r.a.createElement("p",{className:"error"},v),r.a.createElement("button",{type:"submit",className:"button button-primary"},"Submit Score")),i&&l&&r.a.createElement("div",{className:"user-order"},r.a.createElement("h3",null,"Your order was:"),r.a.createElement("div",{className:"country-list"},i.map(e=>r.a.createElement(L,{key:e.id,country:e,isClickable:!0,highlight:e.id===l.id?"incorrect":"",mode:u})))),s&&l&&r.a.createElement("div",{className:"correct-order"},r.a.createElement("h3",null,"The correct order was:"),r.a.createElement("div",{className:"country-list"},s.map(e=>r.a.createElement(L,{key:e.id,country:e,isClickable:!0,highlight:e.id===l.id?"correct":"",mode:u})))),r.a.createElement("div",{className:"game-over-buttons"},r.a.createElement("button",{className:"button button-primary",onClick:()=>t("/game/"+u)},"Play Again"),r.a.createElement("button",{className:"button button-secondary",onClick:()=>t("/")},"Go to Home Page"),r.a.createElement("button",{className:"button button-secondary",onClick:()=>t("/leaderboard")},"View Leaderboard")))};const H=e=>(null===e||void 0===e?void 0:e.toDate)?e.toDate().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;a(51);var B=function(){const[e,t]=Object(n.useState)([]),[a,o]=Object(n.useState)(null);return Object(n.useEffect)(()=>{(()=>{const e=_(a);t(e)})()},[a]),r.a.createElement("div",{className:"leaderboard-page"},r.a.createElement("h2",null,"Leaderboard"),r.a.createElement("div",{className:"mode-filters"},r.a.createElement("button",{className:"button "+(a?"button-secondary":"button-primary"),onClick:()=>o(null)},"All Modes"),r.a.createElement("button",{className:"button "+("population"===a?"button-primary":"button-secondary"),onClick:()=>o("population")},"Population"),r.a.createElement("button",{className:"button "+("area"===a?"button-primary":"button-secondary"),onClick:()=>o("area")},"Area")),r.a.createElement("div",{className:"leaderboard-table"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Rank"),r.a.createElement("th",null,"Player"),r.a.createElement("th",null,"Score"),r.a.createElement("th",null,"Mode"),r.a.createElement("th",null,"Date"))),r.a.createElement("tbody",null,e.map((e,t)=>r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.playerName),r.a.createElement("td",null,e.score),r.a.createElement("td",null,e.mode.charAt(0).toUpperCase()+e.mode.slice(1)),r.a.createElement("td",null,H(e.date))))))))};a(52);var $=e=>{let{avatarOptions:t,selectedAvatar:a,onSelect:n,onClose:o}=e;return r.a.createElement("div",{className:"avatar-selector"},r.a.createElement("div",{className:"avatar-grid"},t.map(e=>r.a.createElement("div",{key:e.id,className:"avatar-option "+(a===e.url?"selected":""),onClick:()=>n(e.url)},r.a.createElement("img",{src:e.url,alt:e.name}),r.a.createElement("span",null,e.name)))))};a(53);var R=e=>{let{profile:t,currentUser:a,avatarOptions:o,onSubmit:c}=e;const[l,i]=Object(n.useState)({nickname:(null===t||void 0===t?void 0:t.nickname)||"",country:(null===t||void 0===t?void 0:t.country)||"",avatarUrl:(null===t||void 0===t?void 0:t.avatarUrl)||o[0].url}),[s,m]=Object(n.useState)(!1),[u,d]=Object(n.useState)(!1),p=e=>{const{name:t,value:a}=e.target;i(e=>({...e,[t]:a})),d(!0)};return r.a.createElement("div",{className:"profile-header"},r.a.createElement("div",{className:"avatar-container"},r.a.createElement("img",{src:l.avatarUrl,alt:"Profile",className:"profile-avatar",onClick:()=>m(!0)}),s&&r.a.createElement($,{avatarOptions:o,selectedAvatar:l.avatarUrl,onSelect:e=>{i(t=>({...t,avatarUrl:e})),m(!1),d(!0)},onClose:()=>m(!1)})),r.a.createElement("div",{className:"profile-info"},r.a.createElement("form",{onSubmit:async e=>{e.preventDefault();try{await c(l),d(!1)}catch(t){console.error("Error saving profile:",t)}},className:"profile-form"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",name:"nickname",value:l.nickname,onChange:p,placeholder:"Set your nickname",className:"inline-input"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",name:"country",value:l.country,onChange:p,placeholder:"Set your country",className:"inline-input"})),r.a.createElement("div",{className:"email-display"},a.email),u&&r.a.createElement("button",{type:"submit",className:"save-button"},"Save Changes"))))};a(54);var J=e=>{let{achievement:t,isUnlocked:a,unlockDate:n}=e;return r.a.createElement("div",{className:"achievement-card "+(a?"unlocked":"locked")},r.a.createElement("div",{className:"achievement-content"},r.a.createElement("div",{className:"achievement-icon"},t.icon),r.a.createElement("div",{className:"achievement-info"},r.a.createElement("h3",null,t.title),r.a.createElement("p",null,t.description),a&&n&&r.a.createElement("div",{className:"achievement-date"},"Unlocked: ",H(n)))),r.a.createElement("div",{className:"achievement-status"},a?"\u2713":"\ud83d\udd12"))};a(55);var Y=e=>{let{achievementDefinitions:t,achievements:a}=e;const n=(e=>{const t=[];return Object.entries(e).forEach(e=>{let[a,n]=e;Object.entries(n.sorting).forEach(e=>{let[n,r]=e;t.push({...r,category:a,type:"sorting"})}),n.gameCount&&t.push({...n.gameCount,category:a,type:"gameCount"})}),t})(t);return r.a.createElement("div",{className:"achievements-section"},r.a.createElement("h2",null,"Achievements"),r.a.createElement("div",{className:"achievements-grid"},n.map(e=>{var t,n,o;return r.a.createElement(J,{key:e.id,achievement:e,isUnlocked:null!==(t=null===a||void 0===a||null===(n=a[e.id])||void 0===n?void 0:n.unlocked)&&void 0!==t&&t,unlockDate:null===a||void 0===a||null===(o=a[e.id])||void 0===o?void 0:o.unlockedAt})})))};a(56);var K=e=>{var t,a;let{game:n,index:o}=e;return r.a.createElement("div",{className:"game-history-item"},r.a.createElement("div",{className:"game-rank"},"#",o+1),r.a.createElement("div",{className:"game-score"},"Score: ",n.score),r.a.createElement("div",{className:"game-mode"},n.category.charAt(0).toUpperCase()+n.category.slice(1)," Mode"),r.a.createElement("div",{className:"game-date"},(null===(t=n.timestamp)||void 0===t?void 0:t.toDate)?H(n.timestamp):"Date unavailable"),r.a.createElement("div",{className:"game-countries"},null===(a=n.countries)||void 0===a?void 0:a.map((e,t)=>r.a.createElement("div",{key:t,className:"country-item"},r.a.createElement("img",{src:e.flagUrl,alt:e.name,className:"country-flag"}),r.a.createElement("span",null,e.name)))))};a(57);var W=e=>{let{gameHistory:t}=e;const a=Object(n.useMemo)(()=>{if(!t||0===Object.keys(t).length)return[];return Object.entries(t).flatMap(e=>{let[t,a]=e;return a.map(e=>({...e,category:t}))}).filter((e,t,a)=>t===a.findIndex(t=>t.id===e.id)).sort((e,t)=>t.score-e.score).slice(0,5)},[t]);return t?0===Object.keys(t).length?r.a.createElement("div",{className:"game-history-section"},r.a.createElement("h2",null,"Best 5 Games"),r.a.createElement("p",null,"No games played yet. Start playing to see your best games here!")):r.a.createElement("div",{className:"game-history-section"},r.a.createElement("h2",null,"Best 5 Games"),r.a.createElement("div",{className:"game-history-list"},a.map((e,t)=>r.a.createElement(K,{key:e.id,game:e,index:t})))):r.a.createElement("div",{className:"game-history-section"},r.a.createElement("h2",null,"Best 5 Games"),r.a.createElement("p",null,"Loading game history..."))};a(58);var Z=()=>{const{currentUser:e}=j(),t=Object(m.o)(),[a,o]=Object(n.useState)(null),[c,l]=Object(n.useState)(null),[i,s]=Object(n.useState)(null),[u,d]=Object(n.useState)(!0),[p,g]=Object(n.useState)(""),[b,v]=Object(n.useState)(!1),[y,E]=Object(n.useState)(!1),[h,f]=Object(n.useState)({nickname:"",country:"",avatarUrl:""}),O=k.getAvatarOptions(),N=M.getAchievementDefinitions(),C=null===e||void 0===e?void 0:e.uid,w=Object(n.useCallback)(async()=>{if(C)try{const[e,t,a]=await Promise.all([S.getUserProfile(C),M.getUserAchievements(C),T.getAllTopGames(C)]);e&&(o(e),f({nickname:e.nickname||"",country:e.country||"",avatarUrl:e.avatarUrl||O[0].url})),l(t),s(a)}catch(p){g("Failed to load profile: "+p.message)}finally{d(!1)}},[C,O]);Object(n.useEffect)(()=>{e&&w()},[e,w]);return e?u?r.a.createElement("div",{className:"profile-page"},"Loading..."):r.a.createElement("div",{className:"profile-page"},r.a.createElement("div",{className:"profile-content"},r.a.createElement(R,{profile:a,currentUser:e,editing:b,formData:h,avatarOptions:O,showAvatarSelector:y,onEdit:()=>v(!0),onAvatarSelect:e=>{f(t=>({...t,avatarUrl:e})),E(!1)},onAvatarSelectorToggle:()=>E(!y),onSubmit:async t=>{t.preventDefault();try{g(""),await S.updateUserProfile(e.uid,h),o(e=>({...e,...h})),v(!1)}catch(p){g("Failed to update profile: "+p.message)}},onChange:e=>{const{name:t,value:a}=e.target;f(e=>({...e,[t]:a}))},onCancel:()=>v(!1)}),p&&r.a.createElement("div",{className:"error-message"},p),r.a.createElement(Y,{achievementDefinitions:N,achievements:c}),r.a.createElement(W,{gameHistory:i}))):(t("/"),null)};a(59);var V=function(){const{currentUser:e}=j(),[t,a]=Object(n.useState)(""),[o,c]=Object(n.useState)([]),[i,s]=Object(n.useState)(!1),[u,d]=Object(n.useState)(""),p=Object(m.o)(),[g]=Object(l.c)();return Object(n.useEffect)(()=>{(async()=>{const t=g.get("lobby");if(t){a(t),s(!1);let n="Player 2";if(e)try{const t=await S.getUserProfile(e.uid);(null===t||void 0===t?void 0:t.nickname)&&(n=t.nickname)}catch(u){console.error("Error fetching user profile:",u)}c([{id:"player2",name:n}])}else{const t=Math.random().toString(36).substring(2,8).toUpperCase();a(t),s(!0);let n="Player 1";if(e)try{const t=await S.getUserProfile(e.uid);(null===t||void 0===t?void 0:t.nickname)&&(n=t.nickname)}catch(u){console.error("Error fetching user profile:",u)}c([{id:"player1",name:n}])}})()},[g,e]),r.a.createElement("div",{className:"game-lobby"},r.a.createElement("h2",null,"Game Lobby"),r.a.createElement("div",{className:"lobby-info"},r.a.createElement("p",null,"Lobby ID: ",r.a.createElement("strong",null,t)),i&&r.a.createElement("button",{className:"button button-secondary copy-button",onClick:()=>{const e=`${window.location.origin}/game/population/cooperation?lobby=${t}`;navigator.clipboard.writeText(e);const a=document.querySelector(".copy-button");a&&(a.textContent="Copied!",setTimeout(()=>{a.textContent="Copy Invite Link"},2e3))}},"Copy Invite Link")),r.a.createElement("div",{className:"players-list"},r.a.createElement("h3",null,"Players in Lobby:"),r.a.createElement("ul",null,o.map(e=>r.a.createElement("li",{key:e.id},e.name)))),u&&r.a.createElement("p",{className:"error"},u),r.a.createElement("div",{className:"lobby-actions"},r.a.createElement("button",{className:"button button-primary",onClick:()=>{o.length<2?d("Waiting for another player to join..."):p("/game/population/cooperation/play",{state:{lobbyId:t,players:o}})}},"Start Game"),r.a.createElement("button",{className:"button button-secondary",onClick:()=>p("/")},"Cancel")))};const X={async addScore(e,t,a,n){try{return(await Object(y.a)(Object(y.b)(f,"scores"),{userId:e,username:t,score:a,gameMode:n,timestamp:Object(y.j)()})).id}catch(r){throw console.error("Error adding score:",r),r}},async getGlobalLeaderboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{const t=Object(y.i)(Object(y.b)(f,"scores"),Object(y.h)("score","desc"),e(e));return(await Object(y.e)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(t){throw console.error("Error getting leaderboard:",t),t}},async getUserBestScores(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;try{const a=Object(y.i)(Object(y.b)(f,"scores"),Object(y.m)("userId","==",e),Object(y.h)("score","desc"),t(t));return(await Object(y.e)(a)).docs.map(e=>({id:e.id,...e.data()}))}catch(a){throw console.error("Error getting user scores:",a),a}}};function Q(){const{currentUser:e,login:t,signup:a,logout:o}=j(),[c,l]=Object(n.useState)(""),[i,s]=Object(n.useState)(""),[m,u]=Object(n.useState)(""),[d,p]=Object(n.useState)(!1),[g,b]=Object(n.useState)(null);return r.a.createElement("div",{style:{padding:"20px"}},r.a.createElement("h2",null,"Firebase Test"),e?r.a.createElement("div",null,r.a.createElement("p",null,"Logged in as: ",e.email),r.a.createElement("button",{onClick:async function(){try{u(""),p(!0),await o()}catch(m){u("Failed to log out: "+m.message)}p(!1)},disabled:d},"Log Out"),r.a.createElement("button",{onClick:async function(){if(e)try{await X.addScore(e.uid,e.email,100,"test"),b("Score added successfully!")}catch(m){b("Failed to add score: "+m.message)}},style:{marginLeft:"10px"}},"Add Test Score"),g&&r.a.createElement("p",null,g)):r.a.createElement("div",null,r.a.createElement("form",{onSubmit:async function(e){e.preventDefault();try{u(""),p(!0),await a(c,i)}catch(m){u("Failed to create an account: "+m.message)}p(!1)}},r.a.createElement("input",{type:"email",value:c,onChange:e=>l(e.target.value),placeholder:"Email",required:!0}),r.a.createElement("input",{type:"password",value:i,onChange:e=>s(e.target.value),placeholder:"Password",required:!0}),r.a.createElement("button",{type:"submit",disabled:d},"Sign Up")),r.a.createElement("form",{onSubmit:async function(e){e.preventDefault();try{u(""),p(!0),await t(c,i)}catch(m){u("Failed to log in: "+m.message)}p(!1)},style:{marginTop:"10px"}},r.a.createElement("button",{type:"submit",disabled:d},"Log In"))),m&&r.a.createElement("p",{style:{color:"red"}},m))}a(60);var ee=function(){const e=Object(m.m)();return Object(n.useEffect)(()=>{d.a.initialize("G-9679TPXEBR")},[]),Object(n.useEffect)(()=>{d.a.send({hitType:"pageview",page:e.pathname})},[e.pathname]),r.a.createElement(N,null,r.a.createElement("div",{className:"App"},r.a.createElement(w,null),r.a.createElement("div",{className:"content"},r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/",element:r.a.createElement(D,null)}),r.a.createElement(m.a,{path:"/game/population",element:r.a.createElement(F,null)}),r.a.createElement(m.a,{path:"/game/population/cooperation",element:r.a.createElement(V,null)}),r.a.createElement(m.a,{path:"/game/population/cooperation/play",element:r.a.createElement(F,null)}),r.a.createElement(m.a,{path:"/game/area",element:r.a.createElement(F,null)}),r.a.createElement(m.a,{path:"/gameover",element:r.a.createElement(z,null)}),r.a.createElement(m.a,{path:"/leaderboard",element:r.a.createElement(B,null)}),r.a.createElement(m.a,{path:"/profile",element:r.a.createElement(Z,null)}),r.a.createElement(m.a,{path:"/test",element:r.a.createElement(Q,null)}))),r.a.createElement(A,null)))};a(61);c.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.a,null,r.a.createElement(i.a,{backend:s.a},r.a.createElement(ee,null)))))}],[[29,1,2]]]);
//# sourceMappingURL=main.edd38d51.chunk.js.map